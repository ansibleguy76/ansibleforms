{
  "type": "object",
  "required": [
    "categories",
    "roles",
    "forms"
  ],
  "properties": {
    "categories": {
      "type": "array",
      "contains": {
        "const": {
          "name": "Default",
          "icon": "bars"
        }
      },
      "items": {
        "type": "object",
        "required": [
          "name",
          "icon"
        ],
        "properties": {
          "name": {
            "$id": "/categories",
            "type": "string"
          },
          "icon": {
            "$id": "/icon",
            "type": "string"
          }
        },
        "additionalProperties": false
      }
    },
    "roles": {
      "type": "array",
      "contains": {
        "const": {
          "name": "public",
          "groups": []
        }
      },
      "items": {
        "type": "object",
        "required": [
          "name",
          "groups"
        ],
        "properties": {
          "name": {
            "$id": "/role",
            "type": "string"
          },
          "groups": {
            "type": "array",
            "items": {
              "type": "string",
              "default": "",
              "pattern": "(\\blocal\\b|\\bldap\\b)\\/.+"
            }
          }
        },
        "additionalProperties": false
      }
    },
    "constants":{
      "type": "object"
    },
    "forms": {
      "type": "array",
      "default": [],
      "items": {
        "type": "object",
        "required": [
          "name",
          "roles",
          "type",
          "fields"
        ],
        "oneOf": [{
            "properties": {
              "type": {
                "enum": ["ansible"]
              },
              "template": {"not":{}},
              "repo": {"not":{}}
            },
            "required": ["playbook"]
          },
          {
            "properties": {
              "type": {
                "enum": ["awx"]
              },
              "playbook": {"not":{}},
              "repo": {"not":{}}
            },
            "required": ["template"]
          },
          {
            "properties": {
              "type": {
                "enum": ["git"]
              },
              "playbook": {"not":{}},
              "template": {"not":{}}
            },
            "required": ["repo"]
          },
          {
            "properties": {
              "type": {
                "enum": ["multi"]
              },
              "playbook": {"not":{}},
              "repo": {"not":{}}
            },
            "required": ["steps"]
          }
        ],
        "properties": {
          "name": {"type": "string"},
          "roles": {
            "type": "array",
            "items": {
              "$ref": "/role"
            }
          },
          "description": {"type": "string"},
          "image": {"type": "string"},
          "icon": {
            "$ref": "/icon"
          },
          "tileClass": {
            "type": "string",
            "pattern": "^has-background-.+"
          },
          "categories": {
            "type": "array",
            "default": ["Default"],
            "items": {
              "$ref": "/categories"
            }
          },
          "steps": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": true
            }
          },
          "type": {
            "type": "string",
            "enum": ["ansible", "awx", "git","multi"]
          },
          "playbook": {"type": "string"},
          "key": {"type": "string"},
          "template": {"type": "string"},
          "repo": {
            "type": "object",
            "additionalProperties": true
          },
          "inventory": {"type": "string"},
          "tags": {"type": "string"},
          "check": {"type": "boolean"},
          "diff": {"type": "boolean"},
          "help": {"type": "string"},
          "source": {"type": "string"},
          "showHelp": {"type": "boolean"},
          "fieldGroupClasses": {
            "type" : "object",
            "additionalProperties" : {
                "type" : "string"
            }
          },
          "fields": {
            "type": "array",
            "items": {
              "type": "object",
              "required": [
                "type",
                "name"
              ],
              "oneOf": [{
                  "properties": {
                    "type": {
                      "enum": ["text", "password"]
                    },
                    "query": {"not":{}},
                    "minValue": {"not":{}},
                    "maxValue": {"not":{}},
                    "expression": {"not":{}},
                    "runLocal": {"not":{}},
                    "dbConfig": {"not":{}},
                    "sticky": {"not":{}},
                    "editable": {"not":{}},
                    "pctColumns": {"not":{}},
                    "filterColumns": {"not":{}},
                    "hide": {"not":{}},
                    "allowDelete": {"not":{}},
                    "allowInsert": {"not":{}},
                    "deleteMarker": {"not":{}},
                    "insertMarker": {"not":{}},
                    "refresh": {"not":{}},
                    "readonlyColumns": {"not":{}},
                    "values": {"not":{}},
                    "isHtml": {"not":{}},
                    "multiple": {"not":{}},
                    "outputObject": {"not":{}}
                  }
                },
                {
                  "properties": {
                    "type": {
                      "enum": ["number"]
                    },
                    "query": {"not":{}},
                    "minLength": {"not":{}},
                    "maxLength": {"not":{}},
                    "expression": {"not":{}},
                    "sticky": {"not":{}},
                    "editable": {"not":{}},
                    "pctColumns": {"not":{}},
                    "filterColumns": {"not":{}},
                    "runLocal": {"not":{}},
                    "dbConfig": {"not":{}},
                    "hide": {"not":{}},
                    "values": {"not":{}},
                    "multiple": {"not":{}},
                    "refresh": {"not":{}},
                    "allowDelete": {"not":{}},
                    "allowInsert": {"not":{}},
                    "deleteMarker": {"not":{}},
                    "insertMarker": {"not":{}},
                    "readonlyColumns": {"not":{}},
                    "isHtml": {"not":{}},
                    "asCredential": {"not":{}},
                    "outputObject": {"not":{}}
                  }
                },
                {
                  "properties": {
                    "type": {
                      "enum": ["radio"]
                    },
                    "query": {"not":{}},
                    "regex": {"not":{}},
                    "minValue": {"not":{}},
                    "maxValue": {"not":{}},
                    "minLength": {"not":{}},
                    "maxLength": {"not":{}},
                    "sticky": {"not":{}},
                    "editable": {"not":{}},
                    "pctColumns": {"not":{}},
                    "filterColumns": {"not":{}},
                    "expression": {"not":{}},
                    "runLocal": {"not":{}},
                    "keydown": {"not":{}},
                    "refresh": {"not":{}},
                    "isHtml": {"not":{}},
                    "dbConfig": {"not":{}},
                    "hide": {"not":{}},
                    "allowDelete": {"not":{}},
                    "allowInsert": {"not":{}},
                    "deleteMarker": {"not":{}},
                    "insertMarker": {"not":{}},
                    "readonlyColumns": {"not":{}},
                    "multiple": {"not":{}},
                    "asCredential": {"not":{}},
                    "outputObject": {"not":{}}
                  },
                  "required": ["values"]
                },
                {
                  "properties": {
                    "type": {
                      "enum": ["checkbox"]
                    },
                    "query": {"not":{}},
                    "regex": {"not":{}},
                    "minValue": {"not":{}},
                    "maxValue": {"not":{}},
                    "minLength": {"not":{}},
                    "maxLength": {"not":{}},
                    "expression": {"not":{}},
                    "sticky": {"not":{}},
                    "editable": {"not":{}},
                    "pctColumns": {"not":{}},
                    "filterColumns": {"not":{}},
                    "runLocal": {"not":{}},
                    "keydown": {"not":{}},
                    "isHtml": {"not":{}},
                    "dbConfig": {"not":{}},
                    "refresh": {"not":{}},
                    "hide": {"not":{}},
                    "values": {"not":{}},
                    "allowDelete": {"not":{}},
                    "allowInsert": {"not":{}},
                    "deleteMarker": {"not":{}},
                    "insertMarker": {"not":{}},
                    "readonlyColumns": {"not":{}},
                    "multiple": {"not":{}},
                    "asCredential": {"not":{}},
                    "outputObject": {"not":{}}
                  }
                },
                {
                  "properties": {
                    "type": {
                      "enum": ["enum"]
                    },
                    "query": {"not":{}},
                    "regex": {"not":{}},
                    "minValue": {"not":{}},
                    "maxValue": {"not":{}},
                    "minLength": {"not":{}},
                    "maxLength": {"not":{}},
                    "sticky": {"not":{}},
                    "editable": {"not":{}},
                    "pctColumns": {"not":{}},
                    "filterColumns": {"not":{}},
                    "expression": {"not":{}},
                    "runLocal": {"not":{}},
                    "keydown": {"not":{}},
                    "refresh": {"not":{}},
                    "allowDelete": {"not":{}},
                    "allowInsert": {"not":{}},
                    "deleteMarker": {"not":{}},
                    "insertMarker": {"not":{}},
                    "readonlyColumns": {"not":{}},
                    "isHtml": {"not":{}},
                    "dbConfig": {"not":{}},
                    "hide": {"not":{}},
                    "outputObject": {"not":{}}
                  },
                  "required": ["values"]
                },
                {
                  "properties": {
                    "type": {
                      "enum": ["query"]
                    },
                    "values": {"not":{}},
                    "regex": {"not":{}},
                    "minValue": {"not":{}},
                    "maxValue": {"not":{}},
                    "minLength": {"not":{}},
                    "maxLength": {"not":{}},
                    "editable": {"not":{}},
                    "expression": {"not":{}},
                    "keydown": {"not":{}},
                    "allowDelete": {"not":{}},
                    "allowInsert": {"not":{}},
                    "deleteMarker": {"not":{}},
                    "insertMarker": {"not":{}},
                    "readonlyColumns": {"not":{}},
                    "isHtml": {"not":{}},
                    "runLocal": {"not":{}},
                    "hide": {"not":{}}
                  },
                  "required": ["query", "dbConfig"]
                },
                {
                  "properties": {
                    "type": {
                      "enum": ["query"]
                    },
                    "values": {"not":{}},
                    "regex": {"not":{}},
                    "editable": {"not":{}},
                    "minValue": {"not":{}},
                    "maxValue": {"not":{}},
                    "minLength": {"not":{}},
                    "maxLength": {"not":{}},
                    "query": {"not":{}},
                    "keydown": {"not":{}},
                    "allowDelete": {"not":{}},
                    "allowInsert": {"not":{}},
                    "deleteMarker": {"not":{}},
                    "insertMarker": {"not":{}},
                    "readonlyColumns": {"not":{}},
                    "isHtml": {"not":{}},
                    "dbConfig": {"not":{}},
                    "hide": {"not":{}}
                  },
                  "required": ["expression"]
                },
                {
                  "properties": {
                    "type": {
                      "enum": ["expression"]
                    },
                    "values": {"not":{}},
                    "minValue": {"not":{}},
                    "maxValue": {"not":{}},
                    "sticky": {"not":{}},
                    "pctColumns": {"not":{}},
                    "filterColumns": {"not":{}},
                    "dbConfig": {"not":{}},
                    "multiple": {"not":{}},
                    "allowDelete": {"not":{}},
                    "allowInsert": {"not":{}},
                    "deleteMarker": {"not":{}},
                    "insertMarker": {"not":{}},
                    "readonlyColumns": {"not":{}},
                    "keydown": {"not":{}},
                    "outputObject": {"not":{}}
                  },
                  "required": ["expression"]
                },
                {
                  "properties": {
                    "type": {
                      "enum": ["expression"]
                    },
                    "values": {"not":{}},
                    "minValue": {"not":{}},
                    "maxValue": {"not":{}},
                    "expression": {"not":{}},
                    "sticky": {"not":{}},
                    "pctColumns": {"not":{}},
                    "filterColumns": {"not":{}},
                    "multiple": {"not":{}},
                    "runLocal": {"not":{}},
                    "allowDelete": {"not":{}},
                    "allowInsert": {"not":{}},
                    "deleteMarker": {"not":{}},
                    "insertMarker": {"not":{}},
                    "readonlyColumns": {"not":{}},
                    "keydown": {"not":{}},
                    "outputObject": {"not":{}}
                  },
                  "required": ["query", "dbConfig"]
                },
                {
                  "properties": {
                    "type": {
                      "enum": ["table"]
                    },
                    "values": {"not":{}},
                    "regex": {"not":{}},
                    "minValue": {"not":{}},
                    "maxValue": {"not":{}},
                    "minLength": {"not":{}},
                    "sticky": {"not":{}},
                    "editable": {"not":{}},
                    "pctColumns": {"not":{}},
                    "filterColumns": {"not":{}},
                    "maxLength": {"not":{}},
                    "multiple": {"not":{}},
                    "refresh": {"not":{}},
                    "outputObject": {"not":{}},
                    "keydown": {"not":{}},
                    "isHtml": {"not":{}},
                    "icon": {"not":{}},
                    "default": {"not":{}}
                  },
                  "required": ["tableFields"]
                }
              ],
              "properties": {
                "type": {
                  "type": "string",
                  "enum": ["text", "password", "checkbox", "enum", "query", "number", "radio", "expression", "table"]
                },
                "name": {
                  "$id": "/formfield",
                  "type": "string"
                },
                "label": {"type": "string"},
                "placeholder": {"type": "string"},
                "group": {"type": "string"},
                "default": {
                  "anyOf": [{"type": "string"},
                    {"type": "boolean"},
                    {"type": "array"},
                    {"type": "integer"}
                  ]
                },
                "noOutput": {"type": "boolean"},
                "asCredential": {"type": "boolean"},
                "required": {
                  "type": "boolean",
                  "default": false
                },
                "sameAs": {
                  "$ref": "/formfield"
                },
                "validIf": {
                    "type": "object",
                    "required": [
                      "field",
                      "description"
                    ],
                    "properties": {
                      "field": {"type": "string"},
                      "description": {"type": "string"}
                    }
                },
                "validIfNot": {
                    "type": "object",
                    "required": [
                      "field",
                      "description"
                    ],
                    "properties": {
                      "field": {"type": "string"},
                      "description": {"type": "string"}
                    }
                },
                "regex": {
                    "type": "object",
                    "required": [
                      "expression",
                      "description"
                    ],
                    "properties": {
                      "expression": {"type": "string"},
                      "description": {"type": "string"}
                    }
                },
                "notIn": {
                  "type": "object",
                  "required": [
                    "field",
                    "description"
                  ],
                  "properties": {
                    "field": {
                      "$ref": "/formfield"
                    },
                    "description": {"type": "string"}
                  }
                },
                "in": {
                  "type": "object",
                  "required": [
                    "field",
                    "description"
                  ],
                  "properties": {
                    "field": {
                      "$ref": "/formfield"
                    },
                    "description": {"type": "string"}
                  }
                },
                "minValue": {"type": "integer"},
                "maxValue": {"type": "integer"},
                "minLength": {"type": "integer"},
                "maxLength": {"type": "integer"},
                "expression": {"type": "string"},
                "ignoreIncomplete": {"type": "boolean"},
                "noLog": {"type": "boolean"},
                "keydown": {"type": "boolean"},
                "refresh": {"type": ["boolean","string"]},
                "isHtml": {"type": "boolean"},
                "runLocal": {"type": "boolean"},
                "query": {"type": "string"},
                "outputObject": {"type": "boolean"},
                "columns": {
                  "type": "array",
                  "items": {"type": "string"}
                },
                "pctColumns": {
                  "type": "array",
                  "items": {"type": "string"}
                },
                "filterColumns": {
                  "type": "array",
                  "items": {"type": "string"}
                },
                "allowDelete": {"type": "boolean"},
                "allowInsert": {"type": "boolean"},
                "deleteMarker": {"type": "string"},
                "insertMarker": {"type": "string"},
                "readonlyColumns": {
                  "type": "array",
                  "items": { "type": "string" }
                },
                "sticky": {"type": "boolean"},
                "editable": {"type": "boolean"},
                "valueColumn": {"type": "string"},
                "previewColumn": {"type": "string"},
                "placeholderColumn": {"type": "string"},
                "dbConfig": {
                  "type": "object",
                  "required": [
                    "name",
                    "type"
                  ],
                  "properties": {
                    "name": {"type": "string"},
                    "type": {
                      "type": "string",
                      "enum": ["mysql", "mssql", "postgres", "mongodb"]
                    }
                  }
                },
                "model": {"type": "string"},
                "help": {"type": "string"},
                "values": {
                  "type": "array",
                  "items": {"type": "string"}
                },
                "multiple": {
                  "type": "boolean",
                  "default": false
                },
                "size": {"type": "integer"},
                "dependencies": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "$ref": "/formfield"
                      },
                      "values": {
                        "type": "array",
                        "items": {
                          "anyOf": [{"type": "string"},
                            {"type": "integer"},
                            {"type": "boolean"}
                          ]
                        }
                      }
                    },
                    "additionalProperties": false
                  }
                },
                "hide": {"type": "boolean"},
                "icon": {
                  "$ref": "/icon"
                },
                "tableFields": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": [
                      "type",
                      "name",
                      "label"
                    ],
                    "oneOf": [{
                        "properties": {
                          "type": {
                            "enum": ["text"]
                          },
                          "minValue": {"not":{}},
                          "maxValue": {"not":{}},
                          "values": {"not":{}},
                          "from": {"not":{}},
                          "outputObject": {"not":{}},
                          "columns": {"not":{}},
                          "pctColumns": {"not":{}},
                          "filterColumns": {"not":{}},
                          "previewColumn": {"not":{}},
                          "valueColumn": {"not":{}}
                        }
                      },
                      {
                        "properties": {
                          "type": {
                            "enum": ["number"]
                          },
                          "minLength": {"not":{}},
                          "maxLength": {"not":{}},
                          "values": {"not":{}},
                          "from": {"not":{}},
                          "outputObject": {"not":{}},
                          "columns": {"not":{}},
                          "pctColumns": {"not":{}},
                          "filterColumns": {"not":{}},
                          "previewColumn": {"not":{}},
                          "valueColumn": {"not":{}}
                        }
                      },
                      {
                        "properties": {
                          "type": {
                            "enum": ["checkbox"]
                          },
                          "regex": {"not":{}},
                          "minValue": {"not":{}},
                          "maxValue": {"not":{}},
                          "minLength": {"not":{}},
                          "maxLength": {"not":{}},
                          "values": {"not":{}},
                          "from": {"not":{}},
                          "outputObject": {"not":{}},
                          "columns": {"not":{}},
                          "pctColumns": {"not":{}},
                          "filterColumns": {"not":{}},
                          "previewColumn": {"not":{}},
                          "valueColumn": {"not":{}}
                        }
                      },
                      {
                        "properties": {
                          "type": {
                            "enum": ["enum"]
                          },
                          "regex": {"not":{}},
                          "minValue": {"not":{}},
                          "maxValue": {"not":{}},
                          "minLength": {"not":{}},
                          "maxLength": {"not":{}},
                          "from": {"not":{}},
                          "outputObject": {"not":{}},
                          "columns": {"not":{}},
                          "pctColumns": {"not":{}},
                          "filterColumns": {"not":{}},
                          "previewColumn": {"not":{}},
                          "valueColumn": {"not":{}}
                        },
                        "required": ["values"]
                      },
                      {
                        "properties": {
                          "type": {
                            "enum": ["query"]
                          },
                          "regex": {"not":{}},
                          "minValue": {"not":{}},
                          "maxValue": {"not":{}},
                          "minLength": {"not":{}},
                          "maxLength": {"not":{}},
                          "values": {"not":{}}
                        },
                        "required": ["from"]
                      }
                    ],
                    "properties": {
                      "type": {
                        "type": "string",
                        "enum": ["text", "password", "checkbox", "enum", "query", "number"]
                      },
                      "name": {"type": "string"},
                      "label": {"type": "string"},
                      "placeholder": {"type": "string"},
                      "from": {"type": "string"},
                      "default": {
                        "anyOf": [{"type": "string"},
                          {"type": "boolean"},
                          {"type": "array"},
                          {"type": "integer"}
                        ]
                      },
                      "required": {
                        "type": "boolean",
                        "default": false
                      },
                      "regex": {
                          "type": "object",
                          "required": [
                            "expression",
                            "description"
                          ],
                          "properties": {
                            "expression": {"type": "string"},
                            "description": {"type": "string"}
                          }
                      },
                      "minValue": {"type": "integer"},
                      "maxValue": {"type": "integer"},
                      "minLength": {"type": "integer"},
                      "maxLength": {"type": "integer"},
                      "values": {
                        "type": "array",
                        "items": {"type": "string"}
                      },
                      "icon": {
                        "$ref": "/icon"
                      },
                      "columns": {
                        "type": "array",
                        "items": {"type": "string"}
                      },
                      "pctColumns": {
                        "type": "array",
                        "items": {"type": "string"}
                      },
                      "filterColumns": {
                        "type": "array",
                        "items": {"type": "string"}
                      },
                      "valueColumn": {"type": "string"},
                      "previewColumn": {"type": "string"},
                      "outputObject": {
                        "type": "boolean",
                        "default": false
                      }
                    },
                    "additionalProperties": false
                  }
                }
              },
              "additionalProperties": false
            }
          }
        },
        "additionalProperties": false
      }
    }

  },
  "additionalProperties": false
}
